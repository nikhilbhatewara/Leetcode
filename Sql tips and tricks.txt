- aggregate functions can be used in dense_rank 
- use sum case when for multiple where conditions
- 
